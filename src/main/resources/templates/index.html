<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Avito Mini</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>

<header class="header">
    <div class="logo">
        Avito<span style="color:#ff6f3c;">Mini</span>
    </div>

    <!-- Поисковая форма -->
    <form class="search-bar" th:action="@{/}" method="get">
        <input type="text"
               name="q"
               placeholder="Поиск по объявлениям"
               th:value="${q}">

        <select name="categoryId">
            <option value="">Все категории</option>
            <option th:each="cat : ${categories}"
                    th:value="${cat.id}"
                    th:text="${cat.name}"
                    th:selected="${categoryId != null and categoryId == cat.id}">
            </option>
        </select>

        <input type="text"
               name="city"
               placeholder="Город"
               th:value="${city}">

        <button type="submit" class="btn-primary">Найти</button>
    </form>

    <!-- Кнопки справа -->
    <div>
        <a th:href="@{/ads/new}" class="btn-primary">+ Подать объявление</a>

        <!-- Показывать "Войти", если пользователь не залогинен -->
        <a th:if="${#authentication == null or !#authentication.authenticated}"
           th:href="@{/auth/login}"
           class="btn-primary">
            Войти
        </a>

        <!-- Показывать "Выйти", если пользователь залогинен -->
        <a th:if="${#authentication != null and #authentication.authenticated}"
           th:href="@{/auth/logout}"
           class="btn-primary">
            Выйти
        </a>
    </div>
</header>

<main>
    <section class="ads-grid">
        <div class="ad-card"
             th:each="ad : ${ads}"
             th:classappend="${ad.promoted} ? ' promoted'">
            <a th:href="@{'/ads/' + ${ad.id}}">
                <h2 class="ad-title"
                    th:text="${ad.title}">Заголовок</h2>
            </a>

            <div class="ad-price"
                 th:text="${#numbers.formatDecimal(ad.price, 0, 'COMMA', 2, 'POINT')} + ' ₽'">
                10 000 ₽
            </div>

            <div class="ad-city"
                 th:text="${ad.city}">
                Москва
            </div>

            <div class="ad-city"
                 th:text="${ad.category != null ? ad.category.name : 'Без категории'}">
                Категория
            </div>

            <div class="ad-city"
                 th:text="${#temporals.format(ad.createdAt, 'dd.MM.yyyy HH:mm')}">
                01.12.2025 12:00
            </div>
        </div>
    </section>
</main>

</body>
</html>